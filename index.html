<!doctype html>
<html>
<head>
<title> MIA BDAY </title>
</head>
<body>

<p>Happy (almost) 100th birthday to the MIA! Start celebrating early with us by giving the gift of art to your online community. Simply select the work you’d like to share, pick your social platform, and inspire wonder through the power of art, just like that. Feels good, doesn’t it?</p>

<img src="https://api.artsmia.org/images/1743/400/medium.jpg">
<img src="https://api.artsmia.org/images/10436/400/medium.jpg">
<img src="https://api.artsmia.org/images/12092/400/medium.jpg">
<img src="https://api.artsmia.org/images/10434/400/medium.jpg">
<img src="https://api.artsmia.org/images/60728/400/medium.jpg">
<img src="https://api.artsmia.org/images/529/400/medium.jpg">
<img src="https://api.artsmia.org/images/98653/400/medium.jpg">
<img src="https://api.artsmia.org/images/3520/400/medium.jpg">
<img src="https://api.artsmia.org/images/5788/400/medium.jpg">
<img src="https://api.artsmia.org/images/303/400/medium.jpg">
<img src="https://api.artsmia.org/images/10361/400/medium.jpg">
<img src="https://api.artsmia.org/images/794/400/medium.jpg">

<script src="node_modules/hellojs/dist/hello.all.js"></script>
<script src="bundle.js"></script>
<script>
  hello.init({ 
    facebook : 283514835175411,
    twitter: 'vJyAEOhA6UfAizVYCoLc0hbye'
  }, {
    redirect_uri: 'authed.html',
    oauth_proxy : 'https://glacial-waters-7413.herokuapp.com/proxy',
    scope: 'photos,publish_files'
  })

  document.addEventListener('click', function(event) {
    var id = event.target.src.match(/images\/(\d+)/)[1]
    if(event.target.nodeName == 'IMG' && id) {
      facebook(id)
      twitter(id)
    }
  })

  function facebook(img) {
    var _art = art[img]
    if(!_art) return

    var message = "Happy (almost) 100th birthday to the MIA! I’m celebrating with "+_art.title+" by "+_art.artist+".\n\nWant to join the party? Visit artsmia.org/100 to give the gift of art to your online community."
    var width = Math.min(3000, _art.width)
    hello('facebook').login().then(function(auth) {
      hello('facebook').api('me/photos', 'POST', {
        message: message, url: 'https://api.artsmia.org/images/'+img+'/'+width+'/large.jpg'
      }).then(function(success) { console.log('facebook', success) }, function(err) { console.log(err) })
    })
  }
  function twitter(img) {
    if(images[img]) {
      var message = "Happy (almost) 100th #BDAYMIA! Celebrate with your own gift of art—visit artsmia.org/100 & share."
      hello('twitter').login().then(function(auth) {
        hello('twitter').api('me/media', 'POST', {
          message: message, file: images[5788], filename: '5788.jpg'
        }).then(function(success) { console.log('twitter', success) }, function(err) { console.log(err) })
      }, function(error) {
        console.log('no twitter! ', error)
      })
    }
  }
</script>
</body>
</html>
